import{_ as i,c as a,o as t,af as l}from"./chunks/framework.26avpAeN.js";const c=JSON.parse('{"title":"NAT VPS 部署","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/nat-vps.md","filePath":"guide/nat-vps.md"}'),e={name:"guide/nat-vps.md"};function n(h,s,p,k,d,r){return t(),a("div",null,[...s[0]||(s[0]=[l(`<h1 id="nat-vps-部署" tabindex="-1">NAT VPS 部署 <a class="header-anchor" href="#nat-vps-部署" aria-label="Permalink to “NAT VPS 部署”">​</a></h1><blockquote><p><a href="https://www.nodeseek.com/post-53609-1" target="_blank" rel="noreferrer">使用NAT VPS搭建饥荒游戏服务器</a></p></blockquote><p>如果您使用的是 NAT VPS（网络地址转换虚拟私有服务器），需要注意一些特殊的配置要求。</p><h2 id="nat-vps-的特点" tabindex="-1">NAT VPS 的特点 <a class="header-anchor" href="#nat-vps-的特点" aria-label="Permalink to “NAT VPS 的特点”">​</a></h2><p>NAT VPS 通常具有以下特点：</p><ul><li>共享公网 IP 地址</li><li>端口需要手动映射</li><li>无法直接绑定公网 IP</li></ul><h2 id="配置要求" tabindex="-1">配置要求 <a class="header-anchor" href="#配置要求" aria-label="Permalink to “配置要求”">​</a></h2><h3 id="端口映射" tabindex="-1">端口映射 <a class="header-anchor" href="#端口映射" aria-label="Permalink to “端口映射”">​</a></h3><p>需要在 VPS 控制面板中映射以下端口：</p><table tabindex="0"><thead><tr><th>VPS 端口</th><th>饥荒服务器端口</th><th>协议</th><th>用途</th></tr></thead><tbody><tr><td>10082</td><td>8082</td><td>TCP</td><td>Web 管理面板</td></tr><tr><td>40999</td><td>10999</td><td>UDP</td><td>游戏服务器主端口（NAT映射）</td></tr><tr><td>40998</td><td>10998</td><td>UDP</td><td>游戏服务器次端口</td></tr></tbody></table><p>注意，映射端口后，虽然在饥荒游戏中可以搜索到房间，但是无法直接加入，需要在游戏中按下键盘左上角的~键调用控制台，并输入直连命令：c_connect(&quot;ip&quot;,40999,&quot;12345&quot;)即可直接加入游戏。其中ip为vps的ip，40999为10999对应的NAT映射的外部端口，12345为房间密码。直连命令也可在dst-admin-go开服面板的操作面板中复制，注意更改端口。</p><h2 id="安装和运行-dst-admin-go-开服面板" tabindex="-1">安装和运行 dst-admin-go 开服面板 <a class="header-anchor" href="#安装和运行-dst-admin-go-开服面板" aria-label="Permalink to “安装和运行 dst-admin-go 开服面板”">​</a></h2><h3 id="创建安装文件夹" tabindex="-1">创建安装文件夹 <a class="header-anchor" href="#创建安装文件夹" aria-label="Permalink to “创建安装文件夹”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/data/docker_data/dst</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   #创建dst文件夹</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/data/docker_data/dst</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      #进入dst文件夹</span></span></code></pre></div><h3 id="编辑-docker-compose-配置文件" tabindex="-1">编辑 docker-compose 配置文件 <a class="header-anchor" href="#编辑-docker-compose-配置文件" aria-label="Permalink to “编辑 docker-compose 配置文件”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose.yml</span></span></code></pre></div><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  dst-admin-go</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">kairlec/dst-admin-go:\${TAG:-latest}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      restart_policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        condition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">always</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        window</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">60s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">dst-admin-go</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./dst-admin-go/saves:/root/.klei/DoNotStarveTogether</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 游戏存档</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./dst-admin-go/backup:/app/backup</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 游戏备份</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./dst-admin-go/mods:/app/mod</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 游戏mod</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">8082:8082/tcp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # for web dashboard</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10999:10999/udp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # NAT mapped port for main game server</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10998:10998/udp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # secondary game server port</span></span></code></pre></div><h3 id="运行" tabindex="-1">运行 <a class="header-anchor" href="#运行" aria-label="Permalink to “运行”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to “注意事项”">​</a></h2><ul><li>确保在 NAT VPS 控制面板中正确映射了 UDP 端口</li><li>使用正确的公网 IP 和端口信息分享给玩家</li><li>定期检查端口映射是否正常工作</li><li>如果遇到连接问题，检查防火墙设置和端口映射</li></ul><p>饥荒服务器的集群配置和世界配置可以通过 DST Admin Go 的 Web 界面进行配置，无需手动编辑配置文件。</p><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to “常见问题”">​</a></h2><h3 id="端口映射后仍无法连接" tabindex="-1">端口映射后仍无法连接 <a class="header-anchor" href="#端口映射后仍无法连接" aria-label="Permalink to “端口映射后仍无法连接”">​</a></h3><ol><li>检查 VPS 控制面板中的端口映射是否已正确应用</li><li>确认防火墙规则允许相应端口的流量</li><li>验证饥荒服务器是否正在运行并监听正确端口</li></ol><h3 id="玩家无法加入游戏" tabindex="-1">玩家无法加入游戏 <a class="header-anchor" href="#玩家无法加入游戏" aria-label="Permalink to “玩家无法加入游戏”">​</a></h3><ol><li>确认分享给玩家的连接信息（IP 和端口）是否正确</li><li>检查集群配置中的 <code>cluster_key</code> 是否设置正确</li><li>验证玩家是否有网络连接问题</li></ol>`,27)])])}const g=i(e,[["render",n]]);export{c as __pageData,g as default};
